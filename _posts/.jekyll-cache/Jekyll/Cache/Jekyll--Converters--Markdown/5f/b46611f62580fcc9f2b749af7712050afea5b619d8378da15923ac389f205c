I"³<h1 id="ç›‘æ§äº‹ä¾‹çš„ç­‰å¾…">ç›‘æ§äº‹ä¾‹çš„ç­‰å¾…</h1>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>select event,sum(decode(wait_Time,0,0,1)) "Prev", sum(decode(wait_Time,0,1,0)) "Curr",count(*) "Tot" from v$session_Wait    group by event order by 4;
</code></pre></div></div>

<h1 id="å›æ»šæ®µçš„äº‰ç”¨æƒ…å†µ">å›æ»šæ®µçš„äº‰ç”¨æƒ…å†µ</h1>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>select name, waits, gets, waits/gets "Ratio"	from v$rollstat C, v$rollname D   where C.usn = D.usn;
</code></pre></div></div>

<h1 id="ç›‘æ§è¡¨ç©ºé—´çš„-io-æ¯”ä¾‹">ç›‘æ§è¡¨ç©ºé—´çš„ I/O æ¯”ä¾‹</h1>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>select B.tablespace_name nam, 
        A.phyblkrd pbr,
        A.phywrts pyw, 
        B.file_name "file", 
        A.phyrds pyr, 
        A.PHYBLKWRT pbw 
from v$filestat A, dba_data_files B   
where A.file# = B.file_id   order by B.tablespace_name;     
</code></pre></div></div>

<h1 id="ç›‘æ§æ–‡ä»¶ç³»ç»Ÿçš„-io-æ¯”ä¾‹">ç›‘æ§æ–‡ä»¶ç³»ç»Ÿçš„ I/O æ¯”ä¾‹</h1>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>select substr(C.file#,1,2) "#",substr(C.name,1,30) "Name", C.bytes, D.phyrds, D.PHYWRTS, C.status from v$datafile C, v$filestat D           
where C.file# = D.file#;
</code></pre></div></div>

<h1 id="ç›‘æ§-sga-çš„å‘½ä¸­ç‡">ç›‘æ§ SGA çš„å‘½ä¸­ç‡</h1>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>select a.value +	b.value "logical_reads", c.	value "phys_reads", round(100 * ((a.value+b.value)-c.value) / (a.value+b.value)) "BUFFER HIT RATIO" 
from v$sysstat a, v$sysstat 	b, v$sysstat c 
where a.statistic# = 38 and 	b.statistic# = 39 and c.statistic# = 40;
</code></pre></div></div>

<h1 id="ç›‘æ§-sga-ä¸­å­—å…¸ç¼“å†²åŒºçš„å‘½ä¸­ç‡">ç›‘æ§ SGA ä¸­å­—å…¸ç¼“å†²åŒºçš„å‘½ä¸­ç‡</h1>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>select parameter, gets,Getmisses , getmisses/(gets+getmisses)*100 "miss ratio",
(1-(sum(getmisses)/ (sum(getmisses)+sum(getmisses))))*100 "Hit ratio" 
from v$rowcache 
where gets+getmisses &lt;&gt;0 
group by parameter, gets, getmisses;
</code></pre></div></div>

<h1 id="ç›‘æ§-sga-ä¸­å…±äº«ç¼“å­˜åŒºçš„å‘½ä¸­ç‡åº”è¯¥å°äº1">ç›‘æ§ SGA ä¸­å…±äº«ç¼“å­˜åŒºçš„å‘½ä¸­ç‡ï¼Œåº”è¯¥å°äº1%</h1>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>select sum(pins)	"Total Pins", sum(reloads)  "Total Reloads", 
sum(reloads)/sum(pins) *100 libcache 
from v$librarycache;                     

select sum(pinhits-reloads)/sum(pins) "hit radio",sum(reloads)/sum(pins) "reload percent" from v$librarycache;
</code></pre></div></div>

<h1 id="ç›‘æ§-sga-ä¸­é‡åšæ—¥å¿—ç¼“å­˜åŒºçš„å‘½ä¸­ç‡åº”è¯¥å°äº1">ç›‘æ§ SGA ä¸­é‡åšæ—¥å¿—ç¼“å­˜åŒºçš„å‘½ä¸­ç‡ï¼Œåº”è¯¥å°äº1%</h1>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT name, gets, misses, immediate_gets, immediate_misses, Decode(gets,0,0,	misses/gets*100) ratio1, 
Decode(immediate_gets+immediate_misses,0,0, immediate_misses/(immediate_gets+immediate_misses)*100) ratio2 
FROM v$latch WHERE name IN ('redo allocation	', 'redo copy');
</code></pre></div></div>

<h1 id="æ•°æ®åº“è¡¨ç©ºé—´ä½¿ç”¨æƒ…å†µç›‘æ§å­—å…¸ç®¡ç†è¡¨ç©ºé—´">æ•°æ®åº“è¡¨ç©ºé—´ä½¿ç”¨æƒ…å†µç›‘æ§(å­—å…¸ç®¡ç†è¡¨ç©ºé—´)</h1>

<p>æ•°æ®åº“è¿è¡Œäº†ä¸€æ®µæ—¶é—´åï¼Œç”±äºä¸æ–­çš„åœ¨è¡¨ç©ºé—´ä¸Šåˆ›å»ºå’Œåˆ é™¤å¯¹è±¡ï¼Œä¼šåœ¨è¡¨ç©ºé—´ä¸Šäº§ç”Ÿå¤§é‡çš„ç¢ç‰‡ï¼ŒDBAåº”è¯¥åŠæ—¶äº†è§£è¡¨ç©ºé—´çš„ç¢ç‰‡å’Œå¯ç”¨ç©ºé—´æƒ…å†µï¼Œä»¥å†³å®šæ˜¯å¦è¦å¯¹ç¢ç‰‡è¿›è¡Œæ•´ç†æˆ–ä¸ºè¡¨ç©ºé—´å¢åŠ æ•°æ®æ–‡ä»¶ã€‚ä»¥ä¸‹ä¸ºå¼•ç”¨çš„å†…å®¹ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>select tablespace_name, 
count(*) chunks , 
max(bytes/1024/1024) max_chunk 
from dba_free_space 
group by tablespace_name; 
</code></pre></div></div>

<p>ä¸Šé¢çš„SQLåˆ—å‡ºäº†æ•°æ®åº“ä¸­æ¯ä¸ªè¡¨ç©ºé—´çš„ç©ºé—²å—æƒ…å†µ,å¦‚ä¸‹æ‰€ç¤º: 
ä»¥ä¸‹ä¸ºå¼•ç”¨çš„å†…å®¹ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>TABLESPACE_NAME         CHUNKS      MAX_CHUNK 
--------------------  ----------   ---------- 
INDX                 1           57.9921875 
RBS                  3           490.992188 
RMAN_TS             1            16.515625 
SYSTEM               1           207.296875 
TEMP                 20          70.8046875 
TOOLS                1           11.8359375 
USERS                67          71.3671875
</code></pre></div></div>

<p>å…¶ä¸­ï¼ŒCHUNKSåˆ—è¡¨ç¤ºè¡¨ç©ºé—´ä¸­æœ‰å¤šå°‘å¯ç”¨çš„ç©ºé—²å—(æ¯ä¸ªç©ºé—²å—æ˜¯ç”±ä¸€äº›è¿ç»­çš„Oracleæ•°æ®å—ç»„æˆ)ï¼Œå¦‚æœè¿™æ ·çš„ç©ºé—²å—è¿‡å¤šï¼Œæ¯”å¦‚å¹³å‡åˆ°æ¯ä¸ªæ•°æ®æ–‡ä»¶ä¸Šè¶…è¿‡äº†100ä¸ªï¼Œé‚£ä¹ˆè¯¥è¡¨ç©ºé—´çš„ç¢ç‰‡çŠ¶å†µå°±æ¯”è¾ƒä¸¥é‡äº†ï¼Œå¯ä»¥å°è¯•ç”¨ä»¥ä¸‹çš„SQLå‘½ä»¤è¿›è¡Œè¡¨ç©ºé—´ç›¸é‚»ç¢ç‰‡çš„æ¥åˆ:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>alter tablespace è¡¨ç©ºé—´å coalesce;
</code></pre></div></div>

<p>ç„¶åå†æ‰§è¡ŒæŸ¥çœ‹è¡¨ç©ºé—´ç¢ç‰‡çš„SQLè¯­å¥ï¼Œçœ‹è¡¨ç©ºé—´çš„ç¢ç‰‡æœ‰æ²¡æœ‰å‡å°‘ã€‚å¦‚æœæ²¡æœ‰æ•ˆæœï¼Œå¹¶ä¸”è¡¨ç©ºé—´çš„ç¢ç‰‡å·²ç»ä¸¥é‡å½±å“åˆ°äº†æ•°æ®åº“çš„è¿è¡Œï¼Œåˆ™è€ƒè™‘å¯¹è¯¥è¡¨ç©ºé—´è¿›è¡Œé‡å»ºã€‚
MAX_CHUNKåˆ—çš„ç»“æœæ˜¯è¡¨ç©ºé—´ä¸Šæœ€å¤§çš„å¯ç”¨å—å¤§å°ï¼Œå¦‚æœè¯¥è¡¨ç©ºé—´ä¸Šçš„å¯¹è±¡æ‰€éœ€åˆ†é…çš„ç©ºé—´(NEXTå€¼)å¤§äºå¯ç”¨å—çš„å¤§å°çš„è¯ï¼Œå°±ä¼šæç¤ºORA-1652ã€ORA-1653ã€ORA-1654çš„é”™è¯¯ä¿¡æ¯ï¼ŒDBAåº”è¯¥åŠæ—¶å¯¹è¡¨ç©ºé—´çš„ç©ºé—´è¿›è¡Œæ‰©å……ï¼Œä»¥é¿å…è¿™äº›é”™è¯¯å‘ç”Ÿã€‚</p>

<h1 id="æŸ¥çœ‹æ•°æ®åº“çš„è¿æ¥æƒ…å†µ">æŸ¥çœ‹æ•°æ®åº“çš„è¿æ¥æƒ…å†µ</h1>

<p>DBAè¦å®šæ—¶å¯¹æ•°æ®åº“çš„è¿æ¥æƒ…å†µè¿›è¡Œæ£€æŸ¥ï¼Œçœ‹ä¸æ•°æ®åº“å»ºç«‹çš„ä¼šè¯æ•°ç›®æ˜¯ä¸æ˜¯æ­£å¸¸ï¼Œå¦‚æœå»ºç«‹äº†è¿‡å¤šçš„è¿æ¥ï¼Œä¼šæ¶ˆè€—æ•°æ®åº“çš„èµ„æºã€‚åŒæ—¶ï¼Œå¯¹ä¸€äº›â€œæŒ‚æ­»â€çš„è¿æ¥ï¼Œå¯èƒ½ä¼šéœ€è¦DBAæ‰‹å·¥è¿›è¡Œæ¸…ç†ã€‚
ä»¥ä¸‹çš„SQLè¯­å¥åˆ—å‡ºå½“å‰æ•°æ®åº“å»ºç«‹çš„ä¼šè¯æƒ…å†µ: ä»¥ä¸‹ä¸ºå¼•ç”¨çš„å†…å®¹ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>select sid,serial#,username,program,machine,status 
from v$session; 
</code></pre></div></div>

<p>è¾“å‡ºç»“æœä¸º: ä»¥ä¸‹ä¸ºå¼•ç”¨çš„å†…å®¹ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SID   SERIAL#    USERNAME    PROGRAM    MACHINE    STATUS 
----  -------  ---------- ----------- ---------------  -------- 
1       1                    ORACLE.EXE   WORK3      ACTIVE 
2       1                    ORACLE.EXE   WORK3      ACTIVE 
3       1                    ORACLE.EXE   WORK3      ACTIVE 
4       1                    ORACLE.EXE   WORK3      ACTIVE 
5       3                    ORACLE.EXE   WORK3      ACTIVE 
6       1                    ORACLE.EXE   WORK3      ACTIVE 
7       1                    ORACLE.EXE   WORK3      ACTIVE 
8       27        SYS        SQLPLUS.EXE  WORKGROUP\WORK3  ACTIVE 
11      5        DBSNMP    dbsnmp.exe   WORKGROUP\WORK3   INACTIVE
</code></pre></div></div>
<p>æ³¨ï¼š</p>
<ul>
  <li>SID ä¼šè¯(session)çš„IDå·ï¼›</li>
  <li>SERIAL# ä¼šè¯çš„åºåˆ—å·ï¼Œå’ŒSIDä¸€èµ·ç”¨æ¥å”¯ä¸€æ ‡è¯†ä¸€ä¸ªä¼šè¯ï¼›</li>
  <li>USERNAME å»ºç«‹è¯¥ä¼šè¯çš„ç”¨æˆ·åï¼›</li>
  <li>PROGRAM è¿™ä¸ªä¼šè¯æ˜¯ç”¨ä»€ä¹ˆå·¥å…·è¿æ¥åˆ°æ•°æ®åº“çš„ï¼›</li>
  <li>STATUS å½“å‰è¿™ä¸ªä¼šè¯çš„çŠ¶æ€ï¼ŒACTIVEè¡¨ç¤ºä¼šè¯æ­£åœ¨æ‰§è¡ŒæŸäº›ä»»åŠ¡ï¼ŒINACTIVEè¡¨ç¤ºå½“å‰ä¼šè¯æ²¡æœ‰æ‰§è¡Œä»»ä½•æ“ä½œã€‚</li>
  <li>å¦‚æœDBAè¦æ‰‹å·¥æ–­å¼€æŸä¸ªä¼šè¯ï¼Œåˆ™æ‰§è¡Œ:
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>alter system kill session 'SID,SERIAL#'; 
</code></pre></div>    </div>
  </li>
</ul>

<p>æ³¨æ„ï¼Œä¸Šä¾‹ä¸­SIDä¸º1åˆ°7(USERNAMEåˆ—ä¸ºç©º)çš„ä¼šè¯ï¼Œæ˜¯Oracleçš„åå°è¿›ç¨‹ï¼Œä¸è¦å¯¹è¿™äº›ä¼šè¯è¿›è¡Œä»»ä½•æ“ä½œã€‚</p>

<h1 id="æŸ¥çœ‹undoå›æ»šç‡">æŸ¥çœ‹undoå›æ»šç‡</h1>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT NAME, VALUE FROM v$sysstat WHERE NAME IN ('user commits', 'transaction rollbacks');
</code></pre></div></div>
:ET
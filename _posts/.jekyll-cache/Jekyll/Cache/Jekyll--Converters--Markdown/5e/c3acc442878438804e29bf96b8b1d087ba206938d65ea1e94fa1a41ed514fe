I"³,<h1 id="ora-01031--æƒé™é—®é¢˜è§£å†³æ–¹æ³•">ORA-01031  æƒé™é—®é¢˜è§£å†³æ–¹æ³•</h1>

<h2 id="è¡¨è±¡">è¡¨è±¡</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>oracle@mmsc101:~/product/11/network/admin&gt; sqlplus sys/sys@mmsgdb as sysdba

SQL*Plus: Release 11.1.0.7.0 - Production on Sun May 15 16:44:47 2011

Copyright (c) 1982, 2008, Oracle.  All rights reserved.

ERROR:
ORA-01031: é‰å†®æªºæ¶“å¶ˆå†»


Enter user-name: 
</code></pre></div></div>

<p>æŠ¥é”™ï¼ŒORA-01031ï¼Œç”¨æˆ·æƒé™ä¸è¶³å¯¼è‡´ï¼Œå®˜æ–¹å‚è€ƒè§£å†³æ–¹æ³•ä¿¡æ¯å¦‚ä¸‹ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>oracle@mmsc101:~/product/11/network/admin&gt; oerr ora 01031
01031, 00000, "insufficient privileges"
// *Cause: An attempt was made to change the current username or password
//         without the appropriate privilege. This error also occurs if
//         attempting to install a database without the necessary operating
//         system privileges.
//         When Trusted Oracle is configure in DBMS MAC, this error may occur
//         if the user was granted the necessary privilege at a higher label
//         than the current login.
// *Action: Ask the database administrator to perform the operation or grant
//          the required privileges.
//          For Trusted Oracle users getting this error although granted the
//          the appropriate privilege at a higher label, ask the database
//          administrator to regrant the privilege at the appropriate label.
oracle@mmsc101:~/product/11/network/admin&gt; 
</code></pre></div></div>

<h2 id="è§£å†³è¿‡ç¨‹">è§£å†³è¿‡ç¨‹</h2>

<p>å°è¯•èµ‹æƒé™</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>grant create session to sys with admin option;
grant dba to sys;
alter user sys default role all;
</code></pre></div></div>

<p>èµ‹æƒé™åå°è¯•ç™»é™†ï¼Œç»“æœï¼šå¤±è´¥</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>oracle@mmsc101:~/product/11/network/admin&gt; sqlplus sys/sys@mmsgdb as sysdba

SQL*Plus: Release 11.1.0.7.0 - Production on Sun May 15 16:59:57 2011

Copyright (c) 1982, 2008, Oracle.  All rights reserved.

ERROR:
ORA-01031: é‰å†®æªºæ¶“å¶ˆå†»


Enter user-name: 
</code></pre></div></div>

<p>ä¹‹åï¼ŒæŸ¥è¯¢è§†å›¾</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SQL&gt; select * from v$pwfile_users;

no rows selected

SQL&gt;
</code></pre></div></div>

<p>è§†å›¾è¡¨ä¸­æ— è®°å½•ï¼Œè¯´æ˜å½“å‰oracleå¹¶æ²¡æœ‰ä½¿ç”¨å£ä»¤æ–‡ä»¶ï¼Œè€Œåœ¨ç³»ç»Ÿçš„dbsç›®å½•ä¸‹ï¼Œçš„ç¡®æ˜¯æœ‰ä¸ªå£ä»¤æ–‡ä»¶çš„ï¼šorapwmmsgdbï¼Œéš¾é“å£ä»¤æ–‡ä»¶æœ‰é—®é¢˜ï¼Œè¿˜æ˜¯ç”¨æˆ·çš„å¯†ç ä¸å¯¹ã€‚è¿™é‡Œå…ˆå¦å®šç”¨æˆ·å¯†ç ä¸å¯¹é—®é¢˜ï¼Œå› ä¸ºå¦‚æœå¯†ç ä¸å¯¹ï¼ŒæŠ¥é”™åˆ™ä¸æ˜¯ORA-01031äº†ï¼Œè€Œæ˜¯å…¶ä»–çš„ORAé”™è¯¯ç äº†ï¼Œé—®é¢˜å°±å‡ºç°åœ¨å£ä»¤æ–‡ä»¶ä¸Šäº†ã€‚</p>

<p>dbsç›®å½•ä¸‹ï¼Œåˆ é™¤åŸæ¥çš„å£ä»¤æ–‡ä»¶ï¼Œå°è¯•é‡æ–°åˆ›å»ºæ–°çš„å£ä»¤æ–‡ä»¶ã€‚</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>oracle@mmsc101:~/product/11/dbs&gt; orapwd
Usage: orapwd file=&lt;fname&gt; password=&lt;password&gt; entries=&lt;users&gt; force=&lt;y/n&gt; ignorecase=&lt;y/n&gt; nosysdba=&lt;y/n&gt;

  where
    file - name of password file (required),
    password - password for SYS, will be prompted if not specified at command line,
    entries - maximum number of distinct DBA (optional),
    force - whether to overwrite existing file (optional),
    ignorecase - passwords are case-insensitive (optional),
    nosysdba - whether to shut out the SYSDBA logon (optional Database Vault only).
    
  There must be no spaces around the equal-to (=) character.
</code></pre></div></div>

<p>åˆ›å»ºæ–°çš„å£ä»¤æ–‡ä»¶</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>oracle@mmsc101:~/product/11/dbs&gt; orapwd file=/opt/oracle/product/11/dbs/orapwmmsgdb password=sys
</code></pre></div></div>

<p>é‡å¯æ•°æ®åº“</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>oracle@mmsc101:~/product/11/dbs&gt; sqlplus / as sysdba

SQL*Plus: Release 11.1.0.7.0 - Production on Sun May 15 17:08:23 2011

Copyright (c) 1982, 2008, Oracle.  All rights reserved.


Connected to:
Oracle Database 11g Enterprise Edition Release 11.1.0.7.0 - 64bit Production
With the Partitioning, Oracle Label Security, OLAP, Data Mining,
Oracle Database Vault and Real Application Testing options

SQL&gt; startup force
ORACLE instance started.

Total System Global Area  567922688 bytes
Fixed Size                  2161600 bytes
Variable Size             243270720 bytes
Database Buffers          314572800 bytes
Redo Buffers                7917568 bytes
Database mounted.
Database opened.
SQL&gt; 
</code></pre></div></div>

<p>å°è¯•ç™»é™†ï¼Œè¿˜æ˜¯æŠ¥é”™ï¼Œç»§ç»­å®šä½</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>oracle@mmsc101:~/product/11/dbs&gt; sqlplus sys/sys@mmsgdb as sysdba

SQL*Plus: Release 11.1.0.7.0 - Production on Sun May 15 17:08:54 2011

Copyright (c) 1982, 2008, Oracle.  All rights reserved.

ERROR:
ORA-01031: é‰å†®æªºæ¶“å¶ˆå†»


Enter user-name: 
ERROR:
ORA-01017: invalid username/password; logon denied


Enter user-name: 
ERROR:
ORA-01017: invalid username/password; logon denied


SP2-0157: unable to CONNECT to ORACLE after 3 attempts, exiting SQL*Plus
oracle@mmsc101:~/product/11/dbs&gt; 
</code></pre></div></div>

<p>å†æ¬¡æŸ¥è¯¢è§†å›¾</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SQL&gt; select * from v$pwfile_users;

no rows selected

SQL&gt;
</code></pre></div></div>

<p>ä»ç„¶æ— æ•°æ®ï¼Œè¯´æ˜è¿˜æ˜¯æ²¡æœ‰ä½¿ç”¨å£ä»¤æ–‡ä»¶ï¼Œç»§ç»­â€¦â€¦</p>

<p>æŸ¥çœ‹tnsæ–‡ä»¶ä¿¡æ¯</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>oracle@mmsc101:~/product/11/network/admin&gt; more tnsnames.ora 
MMSGDB =
  (DESCRIPTION =
    (ADDRESS = (PROTOCOL = TCP)(HOST = 10.137.49.36)(PORT = 1521))
    (CONNECT_DATA =
      (SERVER = DEDICATED)
      (SERVICE_NAME = ora11)
    )
  )

MMSGDB_37 =
  (DESCRIPTION =
    (ADDRESS_LIST =
      (ADDRESS = (PROTOCOL = TCP)(HOST = 10.137.49.37)(PORT = 1521))
    )
    (CONNECT_DATA =
      (SERVICE_NAME = mmsgdb)
    )
  )
oracle@mmsc101:~/product/11/network/admin&gt;
</code></pre></div></div>

<p>tnsæ–‡ä»¶ä¿¡æ¯æ˜¾ç¤ºï¼Œæ•°æ®åº“åæ˜¯mmsgdbï¼Œå®ä¾‹åæ˜¯ora11ï¼Œorapwçš„å¸®åŠ©å‘½ä»¤ä¸­ï¼Œå¹¶æ²¡æœ‰å†™æ˜filenameä¸­è¯¥å¦‚ä½•å‘½åï¼Œå®é™…å‘½åè§„åˆ™åˆ™æ˜¯ï¼š
file=$ORACLE_HOME/dbs/orapw$ORACLE_SID</p>

<p>$ORACLE_SIDæ˜¯ä»€ä¹ˆ</p>

<p>è¿™é‡Œçš„$ORACLE_SIDæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæ•°æ®åº“åï¼Ÿå®ä¾‹åï¼Ÿ</p>

<p>éƒ½ä¸æ˜¯ï¼Œç¡®åˆ‡çš„è®²ï¼Œè¿™ä¸ªä¸œè¥¿æ˜¯ç¯å¢ƒå˜é‡å€¼ã€‚è¯æ®å¦‚ä¸‹ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>oracle@mmsc101:~&gt; more .bash_profile 

export ORACLE_BASE=/opt/oracle
export ORACLE_HOME=/opt/oracle/product/11
export ORA_CRS_HOME=/opt/oracle/product/11
export ORACLE_SID=ora11
export ORACLE_TERM=xterm
export LD_LIBRARY_PATH=$ORACLE_HOME/lib64:$ORACLE_HOME/lib:/usr/lib
export ORACLE_DOC=$ORACLE_HOME/doc
export PATH=$ORACLE_HOME/bin:/sbin:/usr/sbin:/usr/ccs/bin:/usr/bin:/sbin:$ORACLE_HOME/OPatch_11.1.0.8.1/OPatch:$PATH:/bin:/usr/ccs/b
in
export TNS_NAMES=$ORACLE_HOME/network/admin
export TNS_ADMIN=$ORACLE_HOME/network/admin
export DISPLAY=10.137.48.37:1.0
# CLASSPATH must include the following JRE locations:
CLASSPATH=/opt/oracle/product/11/JRE:/opt/oracle/product/11/jlib:/opt/oracle/product/11/rdbms/jlib
export CLASSPATH=$CLASSPATH:/opt/oracle/product/11/network/jlib
export NLS_LANG=AMERICAN_AMERICA.AL32UTF8
</code></pre></div></div>

<p>ä¹‹å‰orapwåˆ›å»ºçš„å£ä»¤æ–‡ä»¶åç§°æ˜¯orapwmmsgdbï¼Œæ˜¾ç„¶æ˜¯æ²¡æœ‰æ­£ç¡®çš„å£ä»¤æ–‡ä»¶ï¼Œå¯¼è‡´OSè®¤è¯å¤±è´¥ï¼Œå°è¯•ä¸MMSGDBå»ºç«‹è¿æ¥ï¼Œæ²¡æœ‰æƒé™å»ç™»é™†å…¶ä»–çš„æ•°æ®åº“ï¼Œè‡ªç„¶æŠ¥æƒé™é—®é¢˜ã€‚</p>

<h2 id="è·å–è§£å†³æ–¹æ³•">è·å–è§£å†³æ–¹æ³•</h2>

<p>é‡æ–°åˆ›å»ºæ­£ç¡®çš„å£ä»¤æ–‡ä»¶ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>oracle@mmsc101:~/product/11/network/admin&gt; orapwd file=/opt/oracle/product/11/dbs/orapwora11 password=sys
</code></pre></div></div>

<h2 id="éªŒè¯æ–¹æ³•æ˜¯å¦æœ‰æ•ˆ">éªŒè¯æ–¹æ³•æ˜¯å¦æœ‰æ•ˆ</h2>

<p>æŸ¥è¯¢è§†å›¾</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>oracle@mmsc101:~/product/11/network/admin&gt; sqlplus / as sysdba

SQL*Plus: Release 11.1.0.7.0 - Production on Sun May 15 18:05:49 2011

Copyright (c) 1982, 2008, Oracle.  All rights reserved.


Connected to:
Oracle Database 11g Enterprise Edition Release 11.1.0.7.0 - 64bit Production
With the Partitioning, Oracle Label Security, OLAP, Data Mining,
Oracle Database Vault and Real Application Testing options

SQL&gt; select * from v$pwfile_users;

USERNAME
--------------------------------------------------------------------------------
SYSDBA          SYSOPER         SYSASM
--------------- --------------- ---------------
SYS
TRUE            TRUE            FALSE


SQL&gt;
</code></pre></div></div>

<p>å·²ç»æœ‰æ•°æ®äº†ï¼Œå°è¯•sysç”¨æˆ·ç™»é™†è¯•è¯•ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>oracle@mmsc101:~/product/11/network/admin&gt; sqlplus sys/sys@mmsgdb as sysdba

SQL*Plus: Release 11.1.0.7.0 - Production on Sun May 15 17:45:21 2011

Copyright (c) 1982, 2008, Oracle.  All rights reserved.


Connected to:
Oracle Database 11g Enterprise Edition Release 11.1.0.7.0 - 64bit Production
With the Partitioning, Oracle Label Security, OLAP, Data Mining,
Oracle Database Vault and Real Application Testing options

SQL&gt; exit
Disconnected from Oracle Database 11g Enterprise Edition Release 11.1.0.7.0 - 64bit Production
With the Partitioning, Oracle Label Security, OLAP, Data Mining,
Oracle Database Vault and Real Application Testing options
oracle@mmsc101:~/product/11/network/admin&gt; 
</code></pre></div></div>

<p>ç™»é™†æˆåŠŸï¼Œé—®é¢˜å¾—åˆ°è§£å†³ã€‚</p>

<h2 id="æ€»ç»“">æ€»ç»“</h2>

<p>1ã€è¿™ä¸ªé—®é¢˜ï¼Œå¼€å§‹æ˜¯æ‰¾å¯»äº†network/adminç›®å½•ä¸‹çš„sqlnet.oraæ–‡ä»¶ï¼Œè®¤ä¸ºæ•°æ®åº“è§£ææ–‡ä»¶å‡ºç°äº†é—®é¢˜ï¼Œä¹Ÿç»™è¯¥æ–‡ä»¶å¢åŠ äº†æƒé™ï¼Œæ²¡å•¥æ•ˆæœã€‚æ¥ç€å°è¯•tnspingæ“ä½œï¼Œå‘ç°æ˜¯å¯ä»¥ä¸æ•°æ®åº“æ­£å¸¸å»ºç«‹è¿æ¥çš„ï¼Œæ­¤è·¯å°±æ­¤ç»ˆæ­¢ï¼Œå› ä¸ºä¸æ˜¯sqlnet.oraæ–‡ä»¶å¯¼è‡´å‡ºç°çš„é—®é¢˜ï¼›</p>

<p>2ã€å°±æ˜¯ç”¨æˆ·çš„å£ä»¤äº†ï¼Œåˆšå¼€å§‹æ˜¯ä¸çŸ¥é“sysç”¨æˆ·çš„å¯†ç æ˜¯å¤šå°‘ï¼ŒæŠ¥é”™ä¹Ÿå°±æ²¡æ”¾åœ¨å¿ƒä¸Šï¼Œå°±ç›´æ¥ä¿®æ”¹äº†sysçš„å¯†ç ä¸ºsysï¼Œå°è¯•ç™»é™†ï¼Œè¿˜æ˜¯æŠ¥é”™ï¼›</p>

<p>3ã€å†æ¥ç€å°±æ˜¯ç»™sysç”¨æˆ·å‰¯æƒé™ï¼Œå› ä¸ºæŠ¥é”™å°±æ˜¯æƒé™ä¸è¶³å•Šï¼Œèµ‹äº†æƒé™åè¿˜æ˜¯æ²¡è§£å†³ï¼›</p>

<p>4ã€è®¤è¯å‡ºç°äº†é—®é¢˜ï¼Ÿäºæ˜¯å°±æŸ¥æ‰¾å£ä»¤é—®é¢˜ï¼ˆå› ä¸ºç™»é™†æ–¹å¼ä¸­ä½¿ç”¨äº†å£ä»¤è®¤è¯æ–¹å¼ç™»é™†ï¼Œè€ŒéOSè®¤è¯ï¼‰ï¼ŒæŸ¥è¯¢è§†å›¾ï¼Œæ²¡æ•°æ®ï¼Œè€Œdbsç›®å½•ä¸‹æœ‰å£ä»¤æ–‡ä»¶ï¼Œç–‘æƒ‘å°±äº§ç”Ÿäº†â€¦â€¦</p>

<p>åšäº†ä¸Šè¿°æ“ä½œåï¼Œæ‰å‘ç°ï¼Œorapwå‘½ä»¤çš„å¸®åŠ©ä¿¡æ¯å¹¶ä¸æ˜¯å¾ˆè¯¦å°½ï¼Œç»™å‡ºçš„fileå‘½åè§„åˆ™ï¼Œæ„Ÿè§‰å¯ä»¥éšæ„å‘½åçš„ï¼Œç»“æœå´ä¸æ˜¯ï¼Œè§„åˆ™åœ¨å¸®åŠ©å‘½ä»¤ä¸­å±•ç¤ºçš„å¹¶ä¸è¯¦ç»†ã€‚</p>

<p>ORA-01031è¿™ä¸ªæƒé™é”™è¯¯é—®é¢˜ï¼Œæ€»çš„æ€»ç»“å¦‚ä¸‹ï¼šé‡è§æ•´é—®é¢˜ï¼Œå…ˆåˆ«åˆ°å¤„ä¹±æ‰¾ä¸œè¥¿ï¼Œå…ˆæŸ¥è¯¢è§†å›¾ï¼Œå› ä¸ºå‡ºç°é—®é¢˜çš„æœ€å¤§å¯èƒ½æ€§å°±æ˜¯å£ä»¤æ–‡ä»¶å‘½åå‡ºé”™äº†ï¼Œè€Œä¸”å£ä»¤æ–‡ä»¶æ˜¯åŒºåˆ†å¤§å°å†™çš„ã€‚</p>

:ET
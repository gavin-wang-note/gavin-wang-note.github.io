<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="description" content="关于软件测试, 与你一起发现更大的世界">
    <meta name="keywords"  content="Gavin的博客, Gavin Blog, 博客, 个人网站">
    <meta name="theme-color" content="#000000">
    
    <!-- Open Graph -->
    <meta property="og:title" content="Curl调用CGI完成UI操作 - Gavin的博客 | Gavin Blog">
    
    <meta property="og:type" content="article">
    <meta property="og:description" content="引言
">
    
    <meta property="article:published_time" content="2016-06-24T00:00:00Z">
    
    
    <meta property="article:author" content="Gavin">
    
    
    <meta property="article:tag" content="curl">
    
    
    <meta property="og:image" content="http://0.0.0.0:4000/img/avatar-gavin.jpg">
    <meta property="og:url" content="http://0.0.0.0:4000/2016/06/24/use-curl-call-api/">
    <meta property="og:site_name" content="Gavin的博客 | Gavin Blog">
    
    <title>Curl调用CGI完成UI操作 - Gavin的博客 | Gavin Blog</title>

    <!-- Web App Manifest -->
    <link rel="manifest" href="/pwa/manifest.json">

    <!-- Favicon -->
    <link rel="shortcut icon" href="/img/favicon.ico">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="http://0.0.0.0:4000/2016/06/24/use-curl-call-api/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/gavin-blog.min.css">

    <!-- Custom Fonts -->
    <!-- <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Gavin change font-awesome CDN to qiniu -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script>
</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">

    <!-- Navigation -->

<nav class="navbar navbar-default navbar-custom navbar-fixed-top">

    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Gavin Blog</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div id="gavinblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/index.html">Home</a>
                    </li>
                    
                    
                    
                    
                    <li>
                        <a href="/about/">About</a>
                    </li>
                    
                    
                    
                    <li>
                        <a href="/archive/">Archive</a>
                    </li>
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#gavinblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    var __GavinNav__ = {
        close: function(){
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        },
        open: function(){
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }

    // Bind Event
    $toggle.addEventListener('click', function(e){
        if ($navbar.className.indexOf('in') > 0) {
            __GavinNav__.close()
        }else{
            __GavinNav__.open()
        }
    })

    /**
     * Since Fastclick is used to delegate 'touchstart' globally
     * to hack 300ms delay in iOS by performing a fake 'click',
     * Using 'e.stopPropagation' to stop 'touchstart' event from 
     * $toggle/$collapse will break global delegation.
     * 
     * Instead, we use a 'e.target' filter to prevent handler
     * added to document close GavinNav.  
     *
     * Also, we use 'click' instead of 'touchstart' as compromise
     */
    document.addEventListener('click', function(e){
        if(e.target == $toggle) return;
        if(e.target.className == 'icon-bar') return;
        __GavinNav__.close();
    })
</script>


    <!-- Post Header -->



<style type="text/css">
    header.intro-header{
        position: relative;
        background-image: url('/img/home-bg.jpg');
        background: ;
    }

    
</style>

<header class="intro-header" >

    <div class="header-mask"></div>
    
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/archive/?tag=curl" title="curl">curl</a>
                        
                    </div>
                    <h1>Curl调用CGI完成UI操作</h1>
                    
                    <h2 class="subheading">Use curl call API</h2>
                    <span class="meta">Posted by Gavin on June 24, 2016</span>
                </div>
            </div>
        </div>
    </div>
</header>






<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

    <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                <!-- Multi-Lingual -->
                

				<h1 id="引言">引言</h1>

<p>Web UI上的所有操作都对应一个CGI(大多是一个HTTP GET请求)，因此如果想快速地进行大量UI操作，可以直接call CGI去完成想要的工作。对于发送一个HTTP请求，绝大多数编程语言都可以做到。如果是自动化测试开发，可能会选择python等比较全面的工具，但如果只是偶尔用之，一个小小的curl，一两行命令就可以满足要求。</p>

<h1 id="示例">示例</h1>

<h2 id="step1-记录下cookie文件testcookie">Step1 记录下cookie文件test.cookie</h2>

<p>–cookie-jar可简化做-c，仅需要登录一次，除非会话过期</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>curl --cookie-jar test.cookie --insecure "https://10.16.17.191:8080/cgi-bin/ezs3/json/login?user_id=admin&amp;password=1"
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="step2-调用对应的api">Step2 调用对应的API</h2>

<p>–cookie可简化做-b，该示例是创建一个叫pool01的pool</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>curl --cookie ezstor.cookie --insecure "https://10.16.17.191:8080/cgi-bin/ezs3/json/poolcreate?poolname=pool01"
</pre></td></tr></tbody></table></code></pre></div></div>

<h1 id="扩展">扩展</h1>

<p>如何抓取API?</p>

<p>可以借助浏览器，F12，就可以抓取自己care的API了</p>

<h1 id="完整脚本示例">完整脚本示例</h1>

<ul>
  <li>说明:</li>
  <li>
    <ul>
      <li>本示例，用于创建集群</li>
    </ul>
  </li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
</pre></td><td class="rouge-code"><pre><span class="c">#!/bin/bash</span>

<span class="nv">public_ip</span><span class="o">=(</span>
172.17.59.101
172.17.59.102
172.17.59.103
<span class="o">)</span>
<span class="nv">storage_ip</span><span class="o">=(</span>
192.168.100.101
192.168.100.102
192.168.100.103
<span class="o">)</span>
<span class="nv">license_info</span><span class="o">=(</span>
CLAWCT-PTWAV4-4K66F0-C3RH9O-8ATUKF-YDO14G-11WI568
CLB2LB-GF94W0-2O11R5-NA4E9L-5B5XRM-9DFK0V-72438U
CLB8TT-70LYWW-5ZYPBB-H0AAR4-126WJ0-VC8END-1H4H309
<span class="o">)</span>
<span class="nv">osd_device</span><span class="o">=</span>sdb

<span class="nv">public_iface</span><span class="o">=</span>eth0
<span class="nv">cluster_iface</span><span class="o">=</span>eth1
<span class="nv">root_passwd</span><span class="o">=</span>1
<span class="nv">cluster_name</span><span class="o">=</span>automation
<span class="nv">ui_account</span><span class="o">=</span>admin
<span class="nv">ui_account_passwd</span><span class="o">=</span>1
<span class="nv">rep_no</span><span class="o">=</span>2
<span class="nv">ntp_server_ip</span><span class="o">=</span>202.120.2.101
<span class="nv">enable_timeout</span><span class="o">=</span>480


<span class="k">function </span>check_network<span class="o">()</span>
<span class="o">{</span>
    <span class="c"># public_interface network status check</span>
    <span class="nb">echo</span> <span class="s2">"@1.Start to check network."</span>
    <span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"  [Public interface]:"</span>
    <span class="k">for</span><span class="o">((</span> <span class="nv">i</span><span class="o">=</span>0<span class="p">;</span> i&lt;<span class="k">${#</span><span class="nv">public_ip</span><span class="p">[@]</span><span class="k">}</span><span class="p">;</span> i++ <span class="o">))</span>
    <span class="k">do
        </span><span class="nv">public_network_status</span><span class="o">=</span><span class="sb">`</span>ping <span class="nt">-c</span> 4 <span class="k">${</span><span class="nv">public_ip</span><span class="p">[i]</span><span class="k">}</span> | <span class="nb">grep</span> <span class="s2">"packet loss"</span> | <span class="nb">awk</span> <span class="nt">-F</span> <span class="s2">" "</span> <span class="s1">'{print $6}'</span><span class="sb">`</span>
        <span class="k">if</span> <span class="o">[[</span> x<span class="s2">"</span><span class="k">${</span><span class="nv">public_network_status</span><span class="k">}</span><span class="s2">"</span> <span class="o">==</span> x<span class="s2">"0%"</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then
            </span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"    </span><span class="k">${</span><span class="nv">public_ip</span><span class="p">[i]</span><span class="k">}</span><span class="s2">  --&gt;  OK"</span>
        <span class="k">else
            </span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"    </span><span class="k">${</span><span class="nv">public_ip</span><span class="p">[i]</span><span class="k">}</span><span class="s2">  --&gt;  OK"</span>
            <span class="k">return </span>1
        <span class="k">fi
    done</span>
    
    <span class="c"># storage_interface network status check</span>
    <span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"  [Storeage interfae]:"</span>
    <span class="k">for</span><span class="o">((</span> <span class="nv">i</span><span class="o">=</span>0<span class="p">;</span>i&lt;<span class="k">${#</span><span class="nv">storage_ip</span><span class="p">[@]</span><span class="k">}</span><span class="p">;</span> i++ <span class="o">))</span>
    <span class="k">do
        </span><span class="nv">storage_network_status</span><span class="o">=</span><span class="sb">`</span>ping <span class="nt">-c</span> 4 <span class="k">${</span><span class="nv">storage_ip</span><span class="p">[i]</span><span class="k">}</span> | <span class="nb">grep</span> <span class="s2">"packet loss"</span> | <span class="nb">awk</span> <span class="nt">-F</span> <span class="s2">" "</span> <span class="s1">'{print $6}'</span><span class="sb">`</span>
        <span class="k">if</span> <span class="o">[[</span> x<span class="s2">"</span><span class="k">${</span><span class="nv">storage_network_status</span><span class="k">}</span><span class="s2">"</span> <span class="o">==</span> x<span class="s2">"0%"</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then
            </span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"    </span><span class="k">${</span><span class="nv">storage_ip</span><span class="p">[i]</span><span class="k">}</span><span class="s2">  --&gt;  OK"</span>
        <span class="k">else
            </span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"    </span><span class="k">${</span><span class="nv">storage_ip</span><span class="p">[i]</span><span class="k">}</span><span class="s2">  --&gt;  OK"</span>
            <span class="k">return </span>1
        <span class="k">fi
    done
    return </span>0
<span class="o">}</span>

<span class="k">function </span>check_apache<span class="o">()</span>
<span class="o">{</span> 
    <span class="c"># network is bad, do not start apache</span>
    <span class="nv">ret</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$?</span><span class="sb">`</span>
    <span class="k">if</span> <span class="o">[[</span> <span class="k">${</span><span class="nv">ret</span><span class="k">}</span> <span class="nt">-eq</span> 1 <span class="o">]]</span><span class="p">;</span> <span class="k">then
        </span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"[ERROR]  network check finish, network is bad."</span>
        <span class="k">return </span>1
    <span class="k">else
        </span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"[Success]  network check finish, network is ok."</span>
    <span class="k">fi
    
    </span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">@2.Start to check apache service."</span>
    <span class="k">for</span><span class="o">((</span> <span class="nv">i</span><span class="o">=</span>0<span class="p">;</span> i&lt;<span class="k">${#</span><span class="nv">public_ip</span><span class="p">[@]</span><span class="k">}</span><span class="p">;</span> i++ <span class="o">))</span>
    <span class="k">do
        for</span><span class="o">((</span> <span class="nv">i</span><span class="o">=</span>0<span class="p">;</span> i&lt;3<span class="p">;</span> i++ <span class="o">))</span>
        <span class="k">do
            </span><span class="nv">ret_code</span><span class="o">=</span><span class="si">$(</span>curl <span class="nt">-I</span> <span class="nt">-m</span> 10 <span class="nt">-o</span> /dev/null <span class="nt">-s</span> <span class="nt">-w</span> %<span class="o">{</span>http_code<span class="o">}</span> <span class="nt">--insecure</span> <span class="nt">--cookie-jar</span> cookie.jar <span class="s2">"https://</span><span class="k">${</span><span class="nv">public_ip</span><span class="p">[i]</span><span class="k">}</span><span class="s2">:8080/cgi-bin/ezs3/json/login?user_id=root&amp;password=</span><span class="k">${</span><span class="nv">root_passwd</span><span class="k">}</span><span class="s2">"</span><span class="si">)</span>
            <span class="k">if</span> <span class="o">[[</span> x<span class="s2">"</span><span class="k">${</span><span class="nv">ret_code</span><span class="k">}</span><span class="s2">"</span> <span class="o">!=</span> x<span class="s2">"200"</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then
                </span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"[ERROR]  Apache's service is bad on </span><span class="k">${</span><span class="nv">public_ip</span><span class="p">[i]</span><span class="k">}</span><span class="s2">, error code is </span><span class="k">${</span><span class="nv">ret_code</span><span class="k">}</span><span class="s2">"</span>
                <span class="k">return </span>1
            <span class="k">else
                </span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"  Apache service on </span><span class="k">${</span><span class="nv">public_ip</span><span class="p">[i]</span><span class="k">}</span><span class="s2">  --&gt;  OK"</span>
            <span class="k">fi
        done
    done

    </span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"[Success] Check Apache service finished, all apache's service are OK."</span>
    <span class="k">return </span>0

:&lt;&lt;<span class="o">!</span>
    <span class="c"># add host to sshpass known list</span>
    <span class="k">for</span><span class="o">((</span> <span class="nv">i</span><span class="o">=</span>0<span class="p">;</span> i&lt;<span class="k">${#</span><span class="nv">public_ip</span><span class="p">[@]</span><span class="k">}</span><span class="p">;</span> i++ <span class="o">))</span>
    <span class="k">do</span>
        <span class="c">#echo ${apache_status}</span>
        sshpass <span class="nt">-p</span> p@ssw0rd ssh <span class="nt">-o</span> <span class="nv">StrictHostKeyChecking</span><span class="o">=</span>no root@<span class="k">${</span><span class="nv">public_ip</span><span class="p">[i]</span><span class="k">}</span> pidof apache2
        <span class="c">#apache_status="sshpass -p p@ssw0rd ssh -o StrictHostKeyChecking=no root@${public_ip[i]} pidof apache2"</span>
        <span class="c">#echo ${apache_status}</span>
    <span class="k">done</span>
    
    <span class="c"># check apache whether or not start</span>
    <span class="k">for</span><span class="o">((</span> <span class="nv">i</span><span class="o">=</span>0<span class="p">;</span> i&lt;<span class="k">${#</span><span class="nv">public_ip</span><span class="p">[@]</span><span class="k">}</span><span class="p">;</span> i++ <span class="o">))</span>
    <span class="k">do
        </span><span class="nv">apache_status</span><span class="o">=</span><span class="s2">"sshpass -p p@ssw0rd ssh -o StrictHostKeyChecking=no root@</span><span class="k">${</span><span class="nv">public_ip</span><span class="p">[i]</span><span class="k">}</span><span class="s2"> pidof apache2"</span>
        <span class="k">if</span> <span class="o">[[</span> x<span class="s2">"</span><span class="k">${</span><span class="nv">apache_status</span><span class="k">}</span><span class="s2">"</span> <span class="o">==</span> x<span class="s2">""</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then
            </span><span class="nb">echo</span> <span class="s2">"apache not started @</span><span class="k">${</span><span class="nv">public_ip</span><span class="p">[i]</span><span class="k">}</span><span class="s2">."</span>
            <span class="k">return </span>1
        <span class="k">else
            </span><span class="nb">echo</span> <span class="s2">"apache started </span><span class="k">${</span><span class="nv">public_ip</span><span class="p">[i]</span><span class="k">}</span><span class="s2">."</span>
        <span class="k">fi
    done
    return </span>0
<span class="o">!</span>
<span class="o">}</span>

<span class="k">function </span>check_license<span class="o">()</span>
<span class="o">{</span>
   <span class="nv">license_array_len</span><span class="o">=</span><span class="k">${#</span><span class="nv">license_info</span><span class="p">[@]</span><span class="k">}</span>
   <span class="nv">storage_ip_len</span><span class="o">=</span><span class="k">${#</span><span class="nv">storage_ip</span><span class="p">[@]</span><span class="k">}</span>

   <span class="k">if</span> <span class="o">[[</span> x<span class="s2">"</span><span class="k">${</span><span class="nv">license_array_len</span><span class="k">}</span><span class="s2">"</span> <span class="nt">-ne</span> x<span class="s2">"</span><span class="k">${</span><span class="nv">storage_ip_len</span><span class="k">}</span><span class="s2">"</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then
      </span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"    [ERROR] Licesne number should same as the number of nodes</span><span class="se">\n</span><span class="s2">"</span>
      <span class="k">return </span>1 
   <span class="k">fi</span>
<span class="o">}</span>


<span class="k">function </span>create_cluster<span class="o">()</span>
<span class="o">{</span>
    <span class="k">for</span><span class="o">((</span> <span class="nv">i</span><span class="o">=</span>0<span class="p">;</span>i&lt;<span class="k">${#</span><span class="nv">storage_ip</span><span class="p">[@]</span><span class="k">}</span><span class="p">;</span>i++<span class="o">))</span>
    <span class="k">do
        if</span> <span class="o">[[</span> <span class="k">${</span><span class="nv">i</span><span class="k">}</span> <span class="nt">-eq</span> 0 <span class="o">]]</span><span class="p">;</span> <span class="k">then 
            </span>cluster_ip+<span class="o">=</span><span class="k">${</span><span class="nv">storage_ip</span><span class="p">[i]</span><span class="k">}</span>
        <span class="k">else
            </span>cluster_ip+<span class="o">=</span>+<span class="k">${</span><span class="nv">storage_ip</span><span class="p">[i]</span><span class="k">}</span>
        <span class="k">fi
    done

    </span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"Login with root account, then create the cluster</span><span class="se">\n</span><span class="s2">"</span>
    curl <span class="nt">--insecure</span> <span class="nt">--cookie-jar</span> cookie.jar <span class="s2">"https://</span><span class="k">${</span><span class="nv">public_ip</span><span class="p">[0]</span><span class="k">}</span><span class="s2">:8080/cgi-bin/ezs3/json/login?user_id=root&amp;password=</span><span class="k">${</span><span class="nv">root_passwd</span><span class="k">}</span><span class="s2">"</span>
    
    curl <span class="nt">--insecure</span> <span class="nt">--cookie</span> cookie.jar <span class="s2">"https://</span><span class="k">${</span><span class="nv">public_ip</span><span class="p">[0]</span><span class="k">}</span><span class="s2">:8080/cgi-bin/ezs3/json/create_cluster?admin_account=</span><span class="k">${</span><span class="nv">ui_account</span><span class="k">}</span><span class="s2">&amp;admin_passwd=</span><span class="k">${</span><span class="nv">ui_account_passwd</span><span class="k">}</span><span class="s2">&amp;cluster_name=</span><span class="k">${</span><span class="nv">cluster_name</span><span class="k">}</span><span class="s2">&amp;license_key=&amp;mons=</span><span class="k">${</span><span class="nv">cluster_ip</span><span class="p">#*+</span><span class="k">}</span><span class="s2">&amp;nodes=</span><span class="k">${</span><span class="nv">cluster_ip</span><span class="k">}</span><span class="s2">&amp;ntp_server_list=</span><span class="k">${</span><span class="nv">ntp_server_ip</span><span class="k">}</span><span class="s2">&amp;rack_id=0&amp;rep_no=2&amp;use_rack_aware=false"</span>
 
    <span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"Account of root logout</span><span class="se">\n</span><span class="s2">"</span>
    curl <span class="nt">--insecure</span> <span class="nt">--cookie</span> cookie.jar <span class="s2">"https://</span><span class="k">${</span><span class="nv">public_ip</span><span class="p">[0]</span><span class="k">}</span><span class="s2">:8080/cgi-bin/ezs3/json/logout"</span>
    
    <span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"Remove cookie.jar</span><span class="se">\n</span><span class="s2">"</span>
    <span class="nb">rm</span> <span class="nt">-rf</span> cookie.jar
    <span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"Sleep 100s, to wait root session timeout</span><span class="se">\n</span><span class="s2">"</span>
    <span class="nb">sleep </span>100
    
    <span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"Login UI with </span><span class="k">${</span><span class="nv">ui_account</span><span class="k">}</span><span class="s2">, then input license/create OSD/enable GW</span><span class="se">\n</span><span class="s2">"</span>
    curl <span class="nt">--insecure</span>  <span class="nt">--cookie-jar</span> ui-cookie.jar <span class="s2">"https://</span><span class="k">${</span><span class="nv">public_ip</span><span class="p">[0]</span><span class="k">}</span><span class="s2">:8080/cgi-bin/ezs3/json/login?user_id=</span><span class="k">${</span><span class="nv">ui_account</span><span class="k">}</span><span class="s2">&amp;password=</span><span class="k">${</span><span class="nv">ui_account_passwd</span><span class="k">}</span><span class="s2">"</span>
<span class="o">}</span>


<span class="k">function </span>input_license<span class="o">()</span>
<span class="o">{</span>
    <span class="k">for</span><span class="o">((</span> <span class="nv">i</span><span class="o">=</span>0<span class="p">;</span>i&lt;<span class="k">${#</span><span class="nv">storage_ip</span><span class="p">[@]</span><span class="k">}</span><span class="p">;</span>i++<span class="o">))</span>
    <span class="k">do 
        </span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"    Input lincesne </span><span class="k">${</span><span class="nv">license_info</span><span class="p">[i]</span><span class="k">}</span><span class="s2"> on </span><span class="k">${</span><span class="nv">storage_ip</span><span class="p">[i]</span><span class="k">}</span><span class="se">\n</span><span class="s2">"</span>
        curl <span class="nt">--insecure</span> <span class="nt">--cookie</span> ui-cookie.jar <span class="s2">"https://</span><span class="k">${</span><span class="nv">public_ip</span><span class="p">[0]</span><span class="k">}</span><span class="s2">:8080/cgi-bin/ezs3/json/license_set?ip=</span><span class="k">${</span><span class="nv">storage_ip</span><span class="p">[i]</span><span class="k">}</span><span class="s2">&amp;key=</span><span class="k">${</span><span class="nv">license_info</span><span class="p">[i]</span><span class="k">}</span><span class="s2">"</span>
        <span class="nb">sleep </span>1
    <span class="k">done</span>
<span class="o">}</span>

<span class="k">function </span>create_and_enable_osd<span class="o">()</span>
<span class="o">{</span>
    <span class="k">for</span><span class="o">((</span> <span class="nv">i</span><span class="o">=</span>0<span class="p">;</span>i&lt;<span class="k">${#</span><span class="nv">storage_ip</span><span class="p">[@]</span><span class="k">}</span><span class="p">;</span>i++<span class="o">))</span>
    <span class="k">do 
        </span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"    Create OSD on node </span><span class="k">${</span><span class="nv">storage_ip</span><span class="p">[i]</span><span class="k">}</span><span class="se">\n</span><span class="s2">"</span>
        curl <span class="nt">--insecure</span> <span class="nt">--cookie</span> ui-cookie.jar <span class="s2">"https://</span><span class="k">${</span><span class="nv">public_ip</span><span class="p">[0]</span><span class="k">}</span><span class="s2">:8080/cgi-bin/ezs3/json/storage_volume_add"</span> <span class="nt">--data</span> <span class="s2">"host=</span><span class="k">${</span><span class="nv">storage_ip</span><span class="p">[i]</span><span class="k">}</span><span class="s2">&amp;name=osd&amp;sv_type=0&amp;data_devs=%5B%22%2Fdev%2F</span><span class="k">${</span><span class="nv">osd_device</span><span class="k">}</span><span class="s2">%22%5D&amp;journal_dev=data&amp;cache_dev=&amp;spare_devs=%5B%5D&amp;dedup=false&amp;compress=false&amp;memory_conserve=false&amp;enable_osd=true&amp;ip=</span><span class="k">${</span><span class="nv">storage_ip</span><span class="p">[i]</span><span class="k">}</span><span class="s2">&amp;cluster_iface=</span><span class="k">${</span><span class="nv">cluster_iface</span><span class="k">}</span><span class="s2">&amp;public_iface=</span><span class="k">${</span><span class="nv">public_iface</span><span class="k">}</span><span class="s2">&amp;pool_to_join=default&amp;add_metadata_pool=true"</span>
        <span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"    Enable  OSD on node </span><span class="k">${</span><span class="nv">storage_ip</span><span class="p">[i]</span><span class="k">}</span><span class="se">\n</span><span class="s2">"</span>
        curl <span class="nt">--insecure</span> <span class="nt">--cookie</span> ui-cookie.jar <span class="s2">"https://</span><span class="k">${</span><span class="nv">public_ip</span><span class="p">[0]</span><span class="k">}</span><span class="s2">:8080/cgi-bin/ezs3/json/node_role_enable_osd?ip=</span><span class="k">${</span><span class="nv">storage_ip</span><span class="p">[i]</span><span class="k">}</span><span class="s2">&amp;sv_list=osd&amp;cluster_iface=</span><span class="k">${</span><span class="nv">cluster_iface</span><span class="k">}</span><span class="s2">&amp;public_iface=</span><span class="k">${</span><span class="nv">public_iface</span><span class="k">}</span><span class="s2">"</span>
        <span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"    Check OSD up/down status on node </span><span class="k">${</span><span class="nv">storage_ip</span><span class="p">[i]</span><span class="k">}</span><span class="se">\n</span><span class="s2">"</span>
        <span class="nv">j</span><span class="o">=</span>1
        <span class="k">while</span> <span class="o">[[</span> <span class="k">${</span><span class="nv">j</span><span class="k">}</span> <span class="nt">-le</span> <span class="k">${</span><span class="nv">enable_timeout</span><span class="k">}</span> <span class="o">]]</span>
        <span class="k">do
           </span><span class="nv">osd_up_nums</span><span class="o">=</span><span class="sb">`</span>ceph osd tree | <span class="nb">grep</span> <span class="nt">-A</span> 2 default_<span class="k">${</span><span class="nv">storage_ip</span><span class="p">[i]</span><span class="k">}</span> | <span class="nb">grep</span> <span class="nt">-i</span> up| <span class="nb">wc</span> <span class="nt">-l</span> 2&gt;&amp;1<span class="sb">`</span>
           <span class="k">if</span> <span class="o">[[</span> <span class="k">${</span><span class="nv">osd_up_nums</span><span class="k">}</span> <span class="nt">-ge</span> 1 <span class="o">]]</span><span class="p">;</span> <span class="k">then
               </span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"        [SUCCESS] OSD is up on node </span><span class="k">${</span><span class="nv">storage_ip</span><span class="p">[i]</span><span class="k">}</span><span class="se">\n</span><span class="s2">"</span>
               <span class="nb">break
           </span><span class="k">else
               </span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"        Node </span><span class="k">${</span><span class="nv">storage_ip</span><span class="p">[i]</span><span class="k">}</span><span class="s2">, the </span><span class="nv">$j</span><span class="s2"> time(s) check OSD up status, total check times is </span><span class="k">${</span><span class="nv">enable_timeout</span><span class="k">}</span><span class="se">\n</span><span class="s2">"</span>
           <span class="k">fi
           </span><span class="nb">let </span>j++
           <span class="nb">sleep </span>1
        <span class="k">done
    done</span>
<span class="o">}</span>


<span class="k">function </span>enable_gw<span class="o">()</span>
<span class="o">{</span>
    <span class="k">for</span><span class="o">((</span> <span class="nv">i</span><span class="o">=</span>0<span class="p">;</span>i&lt;<span class="k">${#</span><span class="nv">storage_ip</span><span class="p">[@]</span><span class="k">}</span><span class="p">;</span>i++<span class="o">))</span>
    <span class="k">do
        </span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"    Enable Gateway on node </span><span class="k">${</span><span class="nv">storage_ip</span><span class="p">[i]</span><span class="k">}</span><span class="se">\n</span><span class="s2">"</span>
        curl <span class="nt">--insecure</span> <span class="nt">--cookie</span> ui-cookie.jar <span class="s2">"https://</span><span class="k">${</span><span class="nv">public_ip</span><span class="p">[0]</span><span class="k">}</span><span class="s2">:8080/cgi-bin/ezs3/json/gateway_role_enable?ip=</span><span class="k">${</span><span class="nv">storage_ip</span><span class="p">[i]</span><span class="k">}</span><span class="s2">&amp;public_iface=</span><span class="k">${</span><span class="nv">public_iface</span><span class="k">}</span><span class="s2">"</span>
        <span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"    Check GW enabled status on node </span><span class="k">${</span><span class="nv">storage_ip</span><span class="p">[i]</span><span class="k">}</span><span class="se">\n</span><span class="s2">"</span>
        <span class="nv">j</span><span class="o">=</span>1
        <span class="k">while</span> <span class="o">[[</span> <span class="k">${</span><span class="nv">j</span><span class="k">}</span> <span class="nt">-le</span> <span class="k">${</span><span class="nv">enable_timeout</span><span class="k">}</span> <span class="o">]]</span>
        <span class="k">do
           </span><span class="nv">ctdb_status</span><span class="o">=</span><span class="sb">`</span>ctdb status | <span class="nb">grep</span> <span class="k">${</span><span class="nv">storage_ip</span><span class="p">[i]</span><span class="k">}</span> | <span class="nb">awk</span> <span class="s1">'{print $3}'</span>| <span class="nb">sed</span> <span class="s1">'s/ //g'</span> 2&gt;&amp;1<span class="sb">`</span>
           <span class="k">if</span> <span class="o">[[</span> x<span class="s2">"</span><span class="k">${</span><span class="nv">ctdb_status</span><span class="k">}</span><span class="s2">"</span> <span class="o">==</span> x<span class="s2">"OK"</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then
               </span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"        [SUCCESS] GW is enabled</span><span class="se">\n</span><span class="s2">"</span>
               <span class="nb">break
           </span><span class="k">else
               </span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"        Node </span><span class="k">${</span><span class="nv">storage_ip</span><span class="p">[i]</span><span class="k">}</span><span class="s2">, the </span><span class="nv">$j</span><span class="s2"> time(s) to check ctdb status, total check times is </span><span class="k">${</span><span class="nv">enable_timeout</span><span class="k">}</span><span class="se">\n</span><span class="s2">"</span>
           <span class="k">fi
           </span><span class="nb">let </span>j++
           <span class="nb">sleep </span>1
        <span class="k">done
    done</span>
<span class="o">}</span>

<span class="k">function </span>cluster_health<span class="o">()</span>
<span class="o">{</span>
    <span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"Check cluster health status</span><span class="se">\n</span><span class="s2">"</span>
    <span class="nv">health_status</span><span class="o">=</span><span class="sb">`</span>ceph <span class="nt">-s</span> | <span class="nb">grep</span> <span class="nt">-i</span> health | <span class="nb">awk</span> <span class="s1">'{print $NF}'</span> | <span class="nb">sed</span> <span class="s1">'s/ //g'</span> 2&gt;&amp;1<span class="sb">`</span>
    <span class="nv">i</span><span class="o">=</span>1
    <span class="k">while</span> <span class="o">[[</span> <span class="nv">$i</span> <span class="nt">-le</span> <span class="k">${</span><span class="nv">enable_timeout</span><span class="k">}</span> <span class="o">]]</span>
    <span class="k">do
        if</span> <span class="o">[[</span> x<span class="s2">"</span><span class="k">${</span><span class="nv">health_status</span><span class="k">}</span><span class="s2">"</span> <span class="o">!=</span> x<span class="s2">"HEALTH_OK"</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then
            </span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"  The </span><span class="nv">$i</span><span class="s2"> time(s) to check cluster health, total check times is </span><span class="k">${</span><span class="nv">enable_timeout</span><span class="k">}</span><span class="se">\n</span><span class="s2">"</span>
            <span class="nb">let </span>i++
            <span class="nb">sleep </span>1
        <span class="k">else
            </span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"  [Success] Cluster health is OK</span><span class="se">\n</span><span class="s2">"</span>
            <span class="nb">break
        </span><span class="k">fi
    done</span>
<span class="o">}</span>

<span class="k">function </span>clean_env<span class="o">()</span>
<span class="o">{</span>
    <span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"Clean current env</span><span class="se">\n</span><span class="s2">"</span>
    <span class="nb">rm </span>ui-cookie.jar
<span class="o">}</span>

<span class="c">#curl -I -o /dev/null -s -w %{http_code} --insecure --cookie-jar cookie.jar "https://172.16.146.130:8080/cgi-bin/ezs3/json/login?user_id=root&amp;password=${root_passwd}"</span>
<span class="c">#code_status=$(curl -I -o /dev/null -s -w %{http_code} --insecure --cookie-jar cookie.jar "https://172.16.146.130:8080/cgi-bin/ezs3/json/login?user_id=root&amp;password=${root_passwd}")</span>
<span class="c">#echo "status: ${code_status}"</span>
<span class="c">#echo "http_code: ${http_code}"</span>

check_network
check_apache
<span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"Do some general checks</span><span class="se">\n</span><span class="s2">"</span>
check_license
<span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"    Check whether the licesne number is the same as the number of nodes    [Success]</span><span class="se">\n</span><span class="s2">"</span>

create_cluster
input_license
create_and_enable_osd
enable_gw
cluster_health
clean_env

</pre></td></tr></tbody></table></code></pre></div></div>



                <hr style="visibility: hidden;">
                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2016/06/12/auto-mount-iscsi/" data-toggle="tooltip" data-placement="top" title="iSCSI自动挂载">
                        Previous<br>
                        <span>iSCSI自动挂载</span>
                        </a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2016/08/28/join-disk-to-raid/" data-toggle="tooltip" data-placement="top" title="磁盘加入RAID组">
                        Next<br>
                        <span>磁盘加入RAID组</span>
                        </a>
                    </li>
                    
                </ul>
                <hr style="visibility: hidden;">

                
                <!-- disqus 评论框 start -->
                <div class="comment">
                    <div id="disqus_thread" class="disqus-thread"></div>
                </div>
                <!-- disqus 评论框 end -->
                

                
            </div>  

    <!-- Side Catalog Container -->
        
            <div class="
                col-lg-2 col-lg-offset-0
                visible-lg-block
                sidebar-container
                catalog-container">
                <div class="side-catalog">
                    <hr class="hidden-sm hidden-xs">
                    <h5>
                        <a class="catalog-toggle" href="#">CATALOG</a>
                    </h5>
                    <ul class="catalog-body"></ul>
                </div>
            </div>
        

    <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                


<section>
    
        <hr class="hidden-sm hidden-xs">
    
    <h5><a href="/archive/">FEATURED TAGS</a></h5>
    <div class="tags">
        
        
        
        </a>
        
        
                <a data-sort="0180" 
                    href="/archive/?tag=oracle"
                    title="oracle"
                    rel="77">oracle</a>
        
                <a data-sort="0189" 
                    href="/archive/?tag=Linux"
                    title="Linux"
                    rel="68">Linux</a>
        
                <a data-sort="0233" 
                    href="/archive/?tag=shell"
                    title="shell"
                    rel="24">shell</a>
        
                <a data-sort="0235" 
                    href="/archive/?tag=Automation"
                    title="Automation"
                    rel="22">Automation</a>
        
                <a data-sort="0240" 
                    href="/archive/?tag=ceph"
                    title="ceph"
                    rel="17">ceph</a>
        
                <a data-sort="0242" 
                    href="/archive/?tag=python"
                    title="python"
                    rel="15">python</a>
        
                <a data-sort="0251" 
                    href="/archive/?tag=Jenkins"
                    title="Jenkins"
                    rel="6">Jenkins</a>
        
                <a data-sort="0252" 
                    href="/archive/?tag=S3"
                    title="S3"
                    rel="5">S3</a>
        
                <a data-sort="0252" 
                    href="/archive/?tag=nose"
                    title="nose"
                    rel="5">nose</a>
        
                <a data-sort="0253" 
                    href="/archive/?tag=JBOD"
                    title="JBOD"
                    rel="4">JBOD</a>
        
                <a data-sort="0253" 
                    href="/archive/?tag=Megacli"
                    title="Megacli"
                    rel="4">Megacli</a>
        
                <a data-sort="0253" 
                    href="/archive/?tag=awk"
                    title="awk"
                    rel="4">awk</a>
        
                <a data-sort="0253" 
                    href="/archive/?tag=perl"
                    title="perl"
                    rel="4">perl</a>
        
                <a data-sort="0254" 
                    href="/archive/?tag=iSCSI"
                    title="iSCSI"
                    rel="3">iSCSI</a>
        
                <a data-sort="0254" 
                    href="/archive/?tag=performance"
                    title="performance"
                    rel="3">performance</a>
        
                <a data-sort="0255" 
                    href="/archive/?tag=APP"
                    title="APP"
                    rel="2">APP</a>
        
                <a data-sort="0255" 
                    href="/archive/?tag=Disk"
                    title="Disk"
                    rel="2">Disk</a>
        
                <a data-sort="0255" 
                    href="/archive/?tag=PVE"
                    title="PVE"
                    rel="2">PVE</a>
        
                <a data-sort="0255" 
                    href="/archive/?tag=RAID"
                    title="RAID"
                    rel="2">RAID</a>
        
                <a data-sort="0255" 
                    href="/archive/?tag=bzip2"
                    title="bzip2"
                    rel="2">bzip2</a>
        
                <a data-sort="0255" 
                    href="/archive/?tag=cosbench"
                    title="cosbench"
                    rel="2">cosbench</a>
        
                <a data-sort="0255" 
                    href="/archive/?tag=mds"
                    title="mds"
                    rel="2">mds</a>
        
                <a data-sort="0255" 
                    href="/archive/?tag=netconsole"
                    title="netconsole"
                    rel="2">netconsole</a>
        
                <a data-sort="0255" 
                    href="/archive/?tag=network"
                    title="network"
                    rel="2">network</a>
        
                <a data-sort="0255" 
                    href="/archive/?tag=pbzip2"
                    title="pbzip2"
                    rel="2">pbzip2</a>
        
                <a data-sort="0255" 
                    href="/archive/?tag=pytest"
                    title="pytest"
                    rel="2">pytest</a>
        
                <a data-sort="0255" 
                    href="/archive/?tag=sed"
                    title="sed"
                    rel="2">sed</a>
        
                <a data-sort="0255" 
                    href="/archive/?tag=ssh"
                    title="ssh"
                    rel="2">ssh</a>
        
                <a data-sort="0255" 
                    href="/archive/?tag=tr"
                    title="tr"
                    rel="2">tr
    </div>
</section>


                <!-- Friends Blog -->
                
<hr>
<h5>FRIENDS</h5>
<ul class="list-inline">
  
  <li><a href=""></a></li>
  
  <li><a href="http://bean-li.github.io/">Bean Li</a></li>
  
  <li><a href="https://zphj1987.com/">武汉-磨渣</a></li>
  
</ul>

            </div>
        </div>
    </div>
</article>

<!-- add support for mathjax by voleking-->






<!-- disqus 公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = "Gavin";
    var disqus_identifier = "/2016/06/24/use-curl-call-api";
    var disqus_url = "http://0.0.0.0:4000/2016/06/24/use-curl-call-api/";

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<!-- disqus 公共JS代码 end -->




<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'hover',
          placement: 'right',
          // icon: '#'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>



    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <!-- SNS Link -->
                


<ul class="list-inline text-center">


  
  
  
  
  
  
  
</ul>

                <p class="copyright text-muted">
                    Copyright &copy; Gavin Blog 2023
                    <br>
                    Powered by <a href="https://gavin-wang-note.github.io/index.html">Gavin Blog</a> |
                    <iframe
                        style="margin-left: 2px; margin-bottom:-5px;"
                        frameborder="0" scrolling="0" width="100px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=gavinpro&repo=gavin.github.io&type=star&count=true" >
                    </iframe>
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<!-- Currently, only navbar scroll-down effect at desktop still depends on this -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/gavin-blog.min.js "></script>

<!-- Service Worker -->

<script src="/js/snackbar.js "></script>
<script src="/js/sw-registration.js "></script>


<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!--
     Because of the native support for backtick-style fenced code blocks
     right within the Markdown is landed in Github Pages,
     From V1.6, There is no need for Highlight.js,
     so Gavinblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/
     - https://github.com/jneen/rouge/wiki/list-of-supported-languages-and-lexers
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->





<!--fastClick.js -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->

<script>
    // dynamic User by Gavin
    var _gaId = 'UA-49627206-1';
    var _gaDomain = '';

    // Originial
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', _gaId, _gaDomain);
    ga('send', 'pageview');
</script>



<!-- Baidu Tongji -->



<!-- Side Catalog -->

<script type="text/javascript">
    function generateCatalog (selector) {

        // interop with multilangual 
        if ('' == 'true') {
            _containerSelector = 'div.post-container.active'
        } else {
            _containerSelector = 'div.post-container'
        }

        // init
        var P = $(_containerSelector),a,n,t,l,i,c;
        a = P.find('h1,h2,h3,h4,h5,h6');

        // clean
        $(selector).html('')

        // appending
        a.each(function () {
            n = $(this).prop('tagName').toLowerCase();
            i = "#"+$(this).prop('id');
            t = $(this).text();
            c = $('<a href="'+i+'" rel="nofollow">'+t+'</a>');
            l = $('<li class="'+n+'_nav"></li>').append(c);
            $(selector).append(l);
        });
        return true;
    }

    generateCatalog(".catalog-body");

    // toggle side catalog
    $(".catalog-toggle").click((function(e){
        e.preventDefault();
        $('.side-catalog').toggleClass("fold")
    }))

    /*
     * Doc: https://github.com/davist11/jQuery-One-Page-Nav
     * Fork by Gavin to support padding
     */
    async("/js/jquery.nav.js", function () {
        $('.catalog-body').onePageNav({
            currentClass: "active",
            changeHash: !1,
            easing: "swing",
            filter: "",
            scrollSpeed: 700,
            scrollOffset: 0,
            scrollThreshold: .2,
            begin: null,
            end: null,
            scrollChange: null,
            padding: 80
        });
    });
</script>



<!-- Multi-Lingual -->



</body>

</html>
